<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KUB Weija Tenancy Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a0ca3;
            --secondary: #7209b7;
            --success: #4cc9f0;
            --warning: #f72585;
            --danger: #e63946;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --sidebar-width: 260px;
            --border-radius: 12px;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }

        .dark-mode {
            --light: #121212;
            --dark: #f8f9fa;
            --gray: #adb5bd;
            --light-gray: #2d2d2d;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            transition: var(--transition);
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: var(--transition);
            z-index: 1000;
            box-shadow: var(--shadow);
        }
        
        .logo-container {
            padding: 0 25px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo i {
            font-size: 28px;
        }
        
        .nav-item {
            padding: 12px 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            text-decoration: none;
            color: rgba(255, 255, 255, 0.8);
            transition: var(--transition);
            font-weight: 500;
        }
        
        .nav-item:hover, .nav-item.active {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border-left: 4px solid white;
        }
        
        .nav-item i {
            width: 20px;
            text-align: center;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 30px;
            transition: var(--transition);
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .page-title h1 {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .page-title p {
            color: var(--gray);
            font-size: 16px;
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .theme-toggle {
            background: var(--light-gray);
            width: 50px;
            height: 26px;
            border-radius: 50px;
            padding: 3px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: var(--transition);
        }
        
        .theme-toggle-ball {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            transition: var(--transition);
            transform: translateX(0);
        }
        
        .dark-mode .theme-toggle-ball {
            transform: translateX(24px);
            background: var(--primary);
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 15px;
            background: var(--light-gray);
            border-radius: 50px;
            cursor: pointer;
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        /* Dashboard Cards */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .dark-mode .card {
            background: var(--light-gray);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        
        .dark-mode .card:hover {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--gray);
        }
        
        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .card-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--primary);
        }
        
        .card-footer {
            font-size: 14px;
            color: var(--gray);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .card-footer i {
            color: var(--success);
        }
        
        .card-expiring .card-icon {
            background: rgba(247, 37, 133, 0.15);
            color: var(--warning);
        }
        
        .card-rent-due .card-icon {
            background: rgba(230, 57, 70, 0.15);
            color: var(--danger);
        }
        
        .card-up-to-date .card-icon {
            background: rgba(76, 201, 240, 0.15);
            color: var(--success);
        }
        
        .card-total .card-icon {
            background: rgba(67, 97, 238, 0.15);
            color: var(--primary);
        }
        
        /* Controls */
        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 30px;
            align-items: center;
        }
        
        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }
        
        .search-box input {
            width: 100%;
            padding: 14px 20px 14px 45px;
            border: 2px solid var(--light-gray);
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: var(--transition);
            background: white;
        }
        
        .dark-mode .search-box input {
            background: var(--light-gray);
            color: var(--dark);
            border-color: #3d3d3d;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--light-gray);
            color: var(--gray);
        }
        
        .dark-mode .btn-outline {
            border-color: #3d3d3d;
            color: var(--gray);
        }
        
        .btn-outline:hover {
            background: var(--light-gray);
            color: var(--dark);
        }
        
        .dark-mode .btn-outline:hover {
            background: #3d3d3d;
        }
        
        /* Table */
        .table-container {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        .dark-mode .table-container {
            background: var(--light-gray);
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            min-width: 1200px;
        }
        
        .data-table th {
            background-color: var(--light-gray);
            padding: 16px 12px;
            text-align: left;
            font-weight: 600;
            color: var(--gray);
            border-bottom: 2px solid var(--light-gray);
            white-space: nowrap;
        }
        
        .dark-mode .data-table th {
            background-color: #2d2d2d;
            border-bottom-color: #3d3d3d;
        }
        
        .data-table td {
            padding: 14px 12px;
            border-bottom: 1px solid var(--light-gray);
            vertical-align: middle;
        }
        
        .dark-mode .data-table td {
            border-bottom-color: #3d3d3d;
        }
        
        .data-table tr:hover {
            background-color: rgba(67, 97, 238, 0.03);
        }
        
        .dark-mode .data-table tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .data-table input, .data-table select {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            font-size: 12px;
            background: white;
        }
        
        .dark-mode .data-table input, 
        .dark-mode .data-table select {
            background: #2d2d2d;
            border-color: #3d3d3d;
            color: var(--dark);
        }
        
        .data-table input:focus, .data-table select:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .row-expiring-3months {
            background-color: rgba(255, 193, 7, 0.1) !important;
            border-left: 4px solid #ffc107;
        }
        
        .row-expiring-2months {
            background-color: rgba(253, 126, 20, 0.1) !important;
            border-left: 4px solid #fd7e14;
        }
        
        .row-expiring-1month {
            background-color: rgba(220, 53, 69, 0.1) !important;
            border-left: 4px solid #dc3545;
        }
        
        .row-rent-due {
            background-color: rgba(23, 162, 184, 0.1) !important;
            border-left: 4px solid #17a2b8;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
        }
        
        .status-badge {
            padding: 4px 10px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-active {
            background: rgba(76, 201, 240, 0.15);
            color: var(--success);
        }
        
        .status-expiring {
            background: rgba(247, 37, 133, 0.15);
            color: var(--warning);
        }
        
        .status-overdue {
            background: rgba(230, 57, 70, 0.15);
            color: var(--danger);
        }
        
        .notes-cell {
            max-width: 250px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .notes-cell:hover {
            white-space: normal;
            overflow: visible;
            position: absolute;
            background: white;
            box-shadow: var(--shadow);
            border-radius: var(--border-radius);
            padding: 10px;
            z-index: 100;
            max-width: 300px;
        }
        
        /* Loading States */
        .skeleton-loader {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .skeleton-card {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: var(--border-radius);
            height: 120px;
        }
        
        .skeleton-row {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .skeleton-cell {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 4px;
            height: 20px;
            flex: 1;
        }
        
        .skeleton-cell.short {
            flex: 0.5;
        }
        
        .skeleton-cell.medium {
            flex: 0.7;
        }
        
        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 0;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 700px;
            max-height: 85vh;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            animation: modalFadeIn 0.3s;
        }
        
        .dark-mode .modal-content {
            background-color: #2d2d2d;
        }
        
        @keyframes modalFadeIn {
            from {opacity: 0; transform: translateY(-50px);}
            to {opacity: 1; transform: translateY(0);}
        }
        
        .modal-header {
            padding: 20px 30px;
            border-bottom: 1px solid var(--light-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .dark-mode .modal-header {
            border-bottom-color: #3d3d3d;
        }
        
        .modal-title {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary);
        }
        
        .close {
            color: var(--gray);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .close:hover {
            color: var(--danger);
        }
        
        .modal-body {
            padding: 30px;
            max-height: calc(85vh - 80px);
            overflow-y: auto;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--gray);
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 14px;
            border: 2px solid var(--light-gray);
            border-radius: var(--border-radius);
            font-size: 14px;
            transition: var(--transition);
            background: white;
        }
        
        .dark-mode .form-group input, 
        .dark-mode .form-group select, 
        .dark-mode .form-group textarea {
            background: #2d2d2d;
            border-color: #3d3d3d;
            color: var(--dark);
        }
        
        .form-group input:focus, 
        .form-group select:focus, 
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--light-gray);
        }
        
        .dark-mode .form-actions {
            border-top-color: #3d3d3d;
        }
        
        /* Loading, Messages */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--gray);
        }
        
        .spinner {
            border: 4px solid var(--light-gray);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
           100% { transform: rotate(360deg); }
        }
        
        .alert {
            padding: 15px;
            border-radius: var(--border-radius);
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .alert i {
            font-size: 24px;
            flex-shrink: 0;
        }
        
        .alert-error {
            background-color: rgba(230, 57, 70, 0.15);
            color: var(--danger);
            border-left: 4px solid var(--danger);
        }
        
        .alert-success {
            background-color: rgba(76, 201, 240, 0.15);
            color: var(--success);
            border-left: 4px solid var(--success);
        }
        
        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--success);
            color: white;
            padding: 16px 24px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .toast i {
            font-size: 20px;
        }
        
        .toast.error {
            background-color: var(--danger);
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
                width: 280px;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                width: 100%;
            }
            
            .menu-toggle {
                display: block;
            }
        }
        
        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }
            
            .dashboard-cards {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 20px;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .toast {
                left: 20px;
                right: 20px;
                bottom: 70px;
            }
        }
        
        .menu-toggle {
            display: none;
            background: var(--primary);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 1001;
            box-shadow: var(--shadow);
        }
        
        @media (max-width: 992px) {
            .menu-toggle {
                display: flex;
            }
        }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 200px;
            box-shadow: var(--shadow);
            border-radius: var(--border-radius);
            z-index: 1;
            margin-top: 5px;
            overflow: hidden;
        }

        .dark-mode .dropdown-menu {
            background-color: #2d2d2d;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            text-decoration: none;
            color: var(--dark);
            transition: var(--transition);
        }

        .dark-mode .dropdown-item {
            color: var(--light);
        }

        .dropdown-item:hover {
            background-color: var(--light-gray);
        }

        .dark-mode .dropdown-item:hover {
            background-color: #3d3d3d;
        }

        .dropdown:hover .dropdown-menu {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo-container">
            <div class="logo">
                <i class="fas fa-home"></i>
                <span>KUB Weija</span>
            </div>
        </div>
        
        <a href="#" class="nav-item active">
            <i class="fas fa-th-large"></i>
            <span>Dashboard</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-building"></i>
            <span>Properties</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-users"></i>
            <span>Tenants</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-file-contract"></i>
            <span>Leases</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-money-bill-wave"></i>
            <span>Payments</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-chart-bar"></i>
            <span>Reports</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-cog"></i>
            <span>Settings</span>
        </a>
    </div>
    
    <div class="menu-toggle">
        <i class="fas fa-bars"></i>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <div class="toast-message"></div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="header">
            <div class="page-title">
                <h1>KUB Weija Tenancy Management</h1>
                <p>Comprehensive tenant management with automated notifications</p>
            </div>
            
            <div class="header-actions">
                <div class="theme-toggle">
                    <div class="theme-toggle-ball"></div>
                </div>
                
                <div class="user-profile">
                    <div class="user-avatar">AD</div>
                    <div class="user-info">
                        <div class="user-name">Admin User</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Dashboard Cards Skeleton -->
        <div class="dashboard-cards" id="dashboardSkeleton">
            <div class="card skeleton-card"></div>
            <div class="card skeleton-card"></div>
            <div class="card skeleton-card"></div>
            <div class="card skeleton-card"></div>
        </div>
        
        <!-- Dashboard Cards -->
        <div class="dashboard-cards" id="dashboardCards" style="display: none;">
            <div class="card card-total">
                <div class="card-header">
                    <div class="card-title">TOTAL TENANTS</div>
                    <div class="card-icon">
                        <i class="fas fa-users"></i>
                    </div>
                </div>
                <div class="card-value" id="totalTenants">0</div>
                <div class="card-footer">
                    <i class="fas fa-arrow-up"></i>
                    <span id="newTenants">0 new this month</span>
                </div>
            </div>
            
            <div class="card card-up-to-date">
                <div class="card-header">
                    <div class="card-title">UP TO DATE</div>
                    <div class="card-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                </div>
                <div class="card-value" id="upToDateCount">0</div>
                <div class="card-footer">
                    <i class="fas fa-arrow-up"></i>
                    <span id="upToDatePercent">0% of tenants</span>
                </div>
            </div>
            
            <div class="card card-expiring">
                <div class="card-header">
                    <div class="card-title">EXPIRING SOON</div>
                    <div class="card-icon">
                        <i class="fas fa-exclamation-circle"></i>
                    </div>
                </div>
                <div class="card-value" id="expiringCount">0</div>
                <div class="card-footer">
                    <i class="fas fa-arrow-up"></i>
                    <span>Needs attention</span>
                </div>
            </div>
            
            <div class="card card-rent-due">
                <div class="card-header">
                    <div class="card-title">OUTSTANDING RENT</div>
                    <div class="card-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                </div>
                <div class="card-value" id="outstandingRent">GHC 0</div>
                <div class="card-footer">
                    <i class="fas fa-arrow-down"></i>
                    <span id="rentDueTenants">From 0 tenants</span>
                </div>
            </div>
        </div>
        
        <!-- Controls -->
        <div class="controls">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Search tenants, rooms, or phone numbers...">
            </div>
            
            <button class="btn btn-primary" onclick="addTenant()">
                <i class="fas fa-plus"></i>
                <span>Add Tenant</span>
            </button>
            
            <button class="btn btn-success" onclick="refreshData()">
                <i class="fas fa-sync"></i>
                <span>Refresh</span>
            </button>
            
            <div class="dropdown">
                <button class="btn btn-outline">
                    <i class="fas fa-bell"></i>
                    <span>Reminders</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="#" onclick="sendExpiryReminders()">
                        <i class="fas fa-envelope"></i>
                        Send Expiry Reminders
                    </a>
                    <a class="dropdown-item" href="#" onclick="sendRentReminders()">
                        <i class="fas fa-envelope"></i>
                        Send Rent Reminders
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Table Container -->
        <div class="table-container">
            <div id="loadingIndicator" class="loading">
                <div class="spinner"></div>
                <p>Loading tenancy data from Google Sheets...</p>
            </div>
            
            <div id="errorMessage" class="alert alert-error" style="display: none;">
                <i class="fas fa-exclamation-circle"></i>
                <div class="alert-message"></div>
            </div>
            
            <!-- Table Skeleton -->
            <div id="tableSkeleton" style="display: none;">
                <div class="skeleton-loader">
                    <div class="skeleton-row">
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell medium"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell medium"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell medium"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell short"></div>
                    </div>
                    <div class="skeleton-row">
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell medium"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell medium"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell medium"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell short"></div>
                    </div>
                    <div class="skeleton-row">
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell medium"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell medium"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell medium"></div>
                        <div class="skeleton-cell"></div>
                        <div class="skeleton-cell short"></div>
                        <div class="skeleton-cell short"></div>
                    </div>
                </div>
            </div>
            
            <table class="data-table" id="tenancyTable" style="display: none;">
                <thead>
                    <tr>
                        <th>Room No.</th>
                        <th>Tenant Name</th>
                        <th>Start Date</th>
                        <th>End Date</th>
                        <th>Amount Due</th>
                        <th>Amount Paid</th>
                        <th>Balance</th>
                        <th>Phone Number</th>
                        <th>ECG Meter No.</th>
                        <th>Email</th>
                        <th>Notes</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="tenancyTableBody">
                    <!-- Data will be populated here -->
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Add/Edit Tenant Modal -->
    <div id="tenantModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Add New Tenant</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form id="tenantForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="roomNo">Room Number</label>
                            <input type="text" id="roomNo" required>
                        </div>
                        <div class="form-group">
                            <label for="tenantName">Tenant Name</label>
                            <input type="text" id="tenantName" required>
                        </div>
                        <div class="form-group">
                            <label for="startDate">Start Date</label>
                            <input type="date" id="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="endDate">End Date</label>
                            <input type="date" id="endDate" required>
                        </div>
                        <div class="form-group">
                            <label for="amountDue">Amount Due (GHC)</label>
                            <input type="number" id="amountDue" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="amountPaid">Amount Paid (GHC)</label>
                            <input type="number" id="amountPaid" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="phoneNumber">Phone Number</label>
                            <input type="tel" id="phoneNumber" required>
                        </div>
                        <div class="form-group">
                            <label for="ecgMeter">ECG Meter Number</label>
                            <input type="text" id="ecgMeter">
                        </div>
                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <input type="email" id="email">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="notes">Notes</label>
                        <textarea id="notes" rows="3"></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" onclick="closeModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Tenant</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <script>
        // Configuration - Only need your Google Apps Script Web App URL
        const SHEET_CONFIG = {
            webAppUrl: 'https://script.google.com/macros/s/AKfycbxm3_fy92qIi5HUlAzfDv7Ihxe0O3phSjhQnte3jqiNiAkQOJvIqa9tIEkysBUIR9f8Vw/exec', // Your web app URL
            range: 'KUB Weija!A:L', // Keep for reference, but not used
            emailService: 'google_apps_script' // Using Apps Script for email
        };
        
        let tenancyData = [];
        let currentEditingRow = null;
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            
            // Show loading states
            document.getElementById('tableSkeleton').style.display = 'block';
            
            // Load data from Google Sheets
            setTimeout(() => {
                loadDataFromGoogleSheets();
            }, 1500);
        });
        
        function initializeApp() {
            // Set up theme toggle
            const themeToggle = document.querySelector('.theme-toggle');
            themeToggle.addEventListener('click', toggleTheme);
            
            // Check for saved theme preference
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.body.classList.add('dark-mode');
            }
            
            // Set up menu toggle for mobile
            const menuToggle = document.querySelector('.menu-toggle');
            menuToggle.addEventListener('click', toggleSidebar);
        }
        
        function setupEventListeners() {
            // Search functionality
            document.getElementById('searchInput').addEventListener('input', filterTable);
            
            // Modal close handlers
            document.querySelector('.close').addEventListener('click', closeModal);
            document.getElementById('tenantModal').addEventListener('click', function(e) {
                if (e.target === this) closeModal();
            });
            
            // Form submission
            document.getElementById('tenantForm').addEventListener('submit', handleFormSubmit);
            
            // Auto-calculate end date when start date changes
            document.getElementById('startDate').addEventListener('change', function() {
                const startDateValue = this.value;
                if (startDateValue) {
                    const calculatedEndDate = calculateEndDate(startDateValue);
                    document.getElementById('endDate').value = calculatedEndDate;
                }
            });
        }
        
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            
            // Save preference
            if (document.body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled');
            } else {
                localStorage.setItem('darkMode', null);
            }
        }
        
        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('active');
        }
        
        // JSONP function to bypass CORS
        function loadDataWithJSONP() {
            return new Promise((resolve, reject) => {
                // Create unique callback name
                const callbackName = 'jsonp_callback_' + Math.round(100000 * Math.random());
                
                // Create script element
                const script = document.createElement('script');
                
                // Set up callback
                window[callbackName] = function(data) {
                    resolve(data);
                    document.head.removeChild(script);
                    delete window[callbackName];
                };
                
                // Handle errors
                script.onerror = function() {
                    reject(new Error('JSONP request failed'));
                    document.head.removeChild(script);
                    delete window[callbackName];
                };
                
                // Set timeout
                setTimeout(() => {
                    if (window[callbackName]) {
                        reject(new Error('JSONP request timeout'));
                        if (script.parentNode) {
                            document.head.removeChild(script);
                        }
                        delete window[callbackName];
                    }
                }, 60000); // 60 second timeout
                
                // Make request
                const url = `${SHEET_CONFIG.webAppUrl}?action=getTenants&callback=${callbackName}&timestamp=${Date.now()}`;
                console.log('Making JSONP request to:', url);
                script.src = url;
                document.head.appendChild(script);
            });
        }
        
        async function loadDataFromGoogleSheets() {
            // Test configuration first
            if (SHEET_CONFIG.webAppUrl === 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE') {
                showError('Please update SHEET_CONFIG with your Google Apps Script Web App URL');
                return;
            }
            
            try {
                showLoading();
                console.log('ðŸš€ Loading data using JSONP to avoid CORS...');
                
                // Use JSONP to bypass CORS
                const result = await loadDataWithJSONP();
                console.log('Response from Google Apps Script:', result);
                
                if (result.success && result.data) {
                    tenancyData = result.data;
                    
                    console.log(`âœ… Loaded ${tenancyData.length} tenant records from Apps Script`);
                    hideLoading();
                    renderTable();
                    updateStatusCards();
                    showToast(`Successfully loaded ${tenancyData.length} tenant records from Google Sheets`);
                    
                } else {
                    hideLoading();
                    if (result.error) {
                        showError(`Google Apps Script Error: ${result.error}`);
                    } else {
                        showError('No data received from Google Apps Script');
                    }
                    
                    // Show troubleshooting info if available
                    if (result.troubleshooting) {
                        console.log('Troubleshooting tips:', result.troubleshooting);
                    }
                }
                
            } catch (error) {
                hideLoading();
                console.error('Error loading from Google Apps Script:', error);
                showError(`Failed to load data: ${error.message}`);
                
                console.log('ðŸ”§ Troubleshooting tips:');
                console.log('1. Make sure your Google Apps Script is deployed as a web app');
                console.log('2. Verify the web app URL is correct');
                console.log('3. Check that the web app allows anonymous access');
                console.log('4. Try opening the web app URL directly in browser to test');
            }
        }
        
        function renderTable() {
            const tbody = document.getElementById('tenancyTableBody');
            tbody.innerHTML = '';
            
            // Hide skeleton and show actual table
            document.getElementById('tableSkeleton').style.display = 'none';
            document.getElementById('tenancyTable').style.display = 'table';
            document.getElementById('dashboardSkeleton').style.display = 'none';
            document.getElementById('dashboardCards').style.display = 'grid';
            
            tenancyData.forEach((tenant, index) => {
                const row = document.createElement('tr');
                
                // Apply color coding based on conditions
                const rentBalance = parseFloat(tenant.rentBalance) || 0;
                const endDate = new Date(tenant.endDate);
                const today = new Date();
                const monthsToExpiry = (endDate - today) / (1000 * 60 * 60 * 24 * 30);
                
                // Only color code for expiry warnings (not rent balance)
                if (monthsToExpiry <= 1 && monthsToExpiry > 0) {
                    row.classList.add('row-expiring-1month');
                } else if (monthsToExpiry <= 2 && monthsToExpiry > 1) {
                    row.classList.add('row-expiring-2months');
                } else if (monthsToExpiry <= 3 && monthsToExpiry > 2) {
                    row.classList.add('row-expiring-3months');
                }
                
                // Format dates properly (dd/mm/yyyy)
                const formattedStartDate = formatDateForDisplay(tenant.startDate);
                const formattedEndDate = formatDateForDisplay(tenant.endDate);
                
                // Determine status
                let statusClass = 'status-active';
                let statusText = 'Current';
                
                if (monthsToExpiry <= 3 && monthsToExpiry > 0) {
                    statusClass = 'status-expiring';
                    statusText = 'Expiring';
                } else if (rentBalance > 0) {
                    statusClass = 'status-overdue';
                    statusText = 'Overdue';
                }
                
                row.innerHTML = `
                    <td>${tenant.roomNo}</td>
                    <td>${tenant.tenantName}</td>
                    <td>${formattedStartDate}</td>
                    <td>${formattedEndDate}</td>
                    <td>GHC ${tenant.amountDue}</td>
                    <td>GHC ${tenant.amountPaid}</td>
                    <td>GHC ${tenant.rentBalance}</td>
                    <td>${tenant.phoneNumber}</td>
                    <td>${tenant.ecgMeter}</td>
                    <td>${tenant.email}</td>
                    <td class="notes-cell" title="${tenant.notes || ''}">${tenant.notes || '-'}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td class="action-buttons">
                        <button class="btn btn-primary btn-sm" onclick="editTenant(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteTenant(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // Function to format date for display (dd/mm/yyyy)
        function formatDateForDisplay(dateString) {
            if (!dateString) return '';
            
            try {
                // Remove the T00:00:00.000Z part if present
                const cleanDateString = dateString.replace('T00:00:00.000Z', '').split('T')[0];
                
                let date;
                if (cleanDateString.includes('/')) {
                    // Already in MM/DD/YYYY or DD/MM/YYYY format
                    return cleanDateString;
                } else if (cleanDateString.includes('-')) {
                    // Convert from YYYY-MM-DD to DD/MM/YYYY
                    const parts = cleanDateString.split('-');
                    if (parts.length === 3) {
                        const year = parts[0];
                        const month = parts[1];
                        const day = parts[2];
                        return `${day}/${month}/${year}`;
                    }
                }
                
                // Try parsing as date and format
                date = new Date(cleanDateString);
                if (date && !isNaN(date.getTime())) {
                    const day = date.getDate().toString().padStart(2, '0');
                    const month = (date.getMonth() + 1).toString().padStart(2, '0');
                    const year = date.getFullYear();
                    return `${day}/${month}/${year}`;
                }
                
                return cleanDateString; // Return as-is if can't parse
            } catch (error) {
                console.log('Error formatting date for display:', dateString, error);
                return dateString;
            }
        }
        
        function updateStatusCards() {
            let expiringCount = 0;
            let rentDueCount = 0;
            let upToDateCount = 0;
            let totalRentDue = 0;
            
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            let newThisMonth = 0;
            
            tenancyData.forEach(tenant => {
                const rentBalance = parseFloat(tenant.rentBalance) || 0;
                const endDate = new Date(tenant.endDate);
                const startDate = new Date(tenant.startDate);
                const monthsToExpiry = (endDate - today) / (1000 * 60 * 60 * 24 * 30);
                
                // Check if tenant started this month
                if (startDate.getMonth() === currentMonth && startDate.getFullYear() === currentYear) {
                    newThisMonth++;
                }
                
                // Count only tenants with expiry within 3 months as "expiring"
                if (monthsToExpiry <= 3 && monthsToExpiry > 0) {
                    expiringCount++;
                } else if (rentBalance > 0) {
                    rentDueCount++;
                    totalRentDue += rentBalance;
                } else {
                    upToDateCount++;
                }
            });
            
            const totalTenants = tenancyData.length;
            const upToDatePercent = totalTenants > 0 ? Math.round((upToDateCount / totalTenants) * 100) : 0;
            
            document.getElementById('totalTenants').textContent = totalTenants;
            document.getElementById('newTenants').textContent = `${newThisMonth} new this month`;
            document.getElementById('upToDateCount').textContent = upToDateCount;
            document.getElementById('upToDatePercent').textContent = `${upToDatePercent}% of tenants`;
            document.getElementById('expiringCount').textContent = expiringCount;
            document.getElementById('outstandingRent').textContent = `GHC ${totalRentDue.toLocaleString()}`;
            document.getElementById('rentDueTenants').textContent = `From ${rentDueCount} tenants`;
        }
        
        function filterTable() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#tenancyTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }
        
        function addTenant() {
            currentEditingRow = null;
            document.getElementById('modalTitle').textContent = 'Add New Tenant';
            document.getElementById('tenantForm').reset();
            document.getElementById('tenantModal').style.display = 'block';
        }
        
        function editTenant(index) {
            currentEditingRow = index;
            const tenant = tenancyData[index];
            
            document.getElementById('modalTitle').textContent = 'Edit Tenant';
            document.getElementById('roomNo').value = tenant.roomNo;
            document.getElementById('tenantName').value = tenant.tenantName;
            
            // Convert dates to proper format for date inputs (YYYY-MM-DD)
            document.getElementById('startDate').value = formatDateForInput(tenant.startDate);
            document.getElementById('endDate').value = formatDateForInput(tenant.endDate);
            
            document.getElementById('amountDue').value = tenant.amountDue;
            document.getElementById('amountPaid').value = tenant.amountPaid;
            document.getElementById('phoneNumber').value = tenant.phoneNumber;
            document.getElementById('ecgMeter').value = tenant.ecgMeter;
            document.getElementById('email').value = tenant.email;
            document.getElementById('notes').value = tenant.notes || '';
            
            document.getElementById('tenantModal').style.display = 'block';
        }
        
        // Helper function to format dates for HTML date inputs
        function formatDateForInput(dateString) {
            if (!dateString) return '';
            
            try {
                // Handle different date formats that might come from Google Sheets
                let date;
                
                if (dateString.includes('/')) {
                    // Handle MM/DD/YYYY or DD/MM/YYYY format
                    const parts = dateString.split('/');
                    if (parts.length === 3) {
                        // Assume MM/DD/YYYY format (adjust if your sheet uses DD/MM/YYYY)
                        date = new Date(parts[2], parts[0] - 1, parts[1]);
                    }
                } else if (dateString.includes('-')) {
                    // Handle YYYY-MM-DD or DD-MM-YYYY format
                    date = new Date(dateString);
                } else {
                    // Try to parse as-is
                    date = new Date(dateString);
                }
                
                // Return in YYYY-MM-DD format for HTML date input
                if (date && !isNaN(date.getTime())) {
                    return date.toISOString().split('T')[0];
                }
                
                return '';
            } catch (error) {
                console.log('Error formatting date:', dateString, error);
                return '';
            }
        }
        
        // Function to calculate end date (start date + 11 months)
        function calculateEndDate(startDateValue) {
            if (!startDateValue) return '';
            
            try {
                const startDate = new Date(startDateValue);
                if (isNaN(startDate.getTime())) return '';
                
                // Add 11 months
                const endDate = new Date(startDate);
                endDate.setMonth(endDate.getMonth() + 11);
                
                // Return in YYYY-MM-DD format for the date input
                return endDate.toISOString().split('T')[0];
            } catch (error) {
                console.log('Error calculating end date:', error);
                return '';
            }
        }
        
        function deleteTenant(index) {
            if (confirm('Are you sure you want to delete this tenant record?')) {
                tenancyData.splice(index, 1);
                renderTable();
                updateStatusCards();
                showToast('Tenant record deleted successfully.');
            }
        }
        
        function closeModal() {
            document.getElementById('tenantModal').style.display = 'none';
        }
        
        function handleFormSubmit(e) {
            e.preventDefault();
            
            const formData = {
                roomNo: document.getElementById('roomNo').value,
                tenantName: document.getElementById('tenantName').value,
                startDate: formatDateForStorage(document.getElementById('startDate').value),
                endDate: formatDateForStorage(document.getElementById('endDate').value),
                amountDue: document.getElementById('amountDue').value,
                amountPaid: document.getElementById('amountPaid').value,
                rentBalance: (parseFloat(document.getElementById('amountDue').value) - parseFloat(document.getElementById('amountPaid').value)).toFixed(2),
                phoneNumber: document.getElementById('phoneNumber').value,
                ecgMeter: document.getElementById('ecgMeter').value,
                email: document.getElementById('email').value,
                notes: document.getElementById('notes').value
            };
            
            if (currentEditingRow !== null) {
                // Edit existing tenant
                tenancyData[currentEditingRow] = formData;
                showToast('Tenant record updated successfully.');
            } else {
                // Add new tenant
                tenancyData.push(formData);
                showToast('New tenant added successfully.');
            }
            
            renderTable();
            updateStatusCards();
            closeModal();
            
            // In production, sync with Google Sheets via Apps Script
            // syncTenantData(formData, currentEditingRow);
        }
        
        // Helper function to format date for display/storage
        function formatDateForStorage(dateInput) {
            if (!dateInput) return '';
            
            try {
                const date = new Date(dateInput);
                if (isNaN(date.getTime())) return dateInput; // Return original if invalid
                
                // Format as MM/DD/YYYY (or adjust to match your sheet format)
                const month = (date.getMonth() + 1).toString().padStart(2, '0');
                const day = date.getDate().toString().padStart(2, '0');
                const year = date.getFullYear();
                
                return `${month}/${day}/${year}`;
            } catch (error) {
                console.log('Error formatting date for storage:', dateInput, error);
                return dateInput;
            }
        }
        
        function makeJSONPRequest(action, params = {}) {
            return new Promise((resolve, reject) => {
                const callbackName = 'jsonp_callback_' + Math.round(100000 * Math.random());
                const script = document.createElement('script');
                
                window[callbackName] = function(data) {
                    resolve(data);
                    document.head.removeChild(script);
                    delete window[callbackName];
                };
                
                script.onerror = function() {
                    reject(new Error('JSONP request failed'));
                    document.head.removeChild(script);
                    delete window[callbackName];
                };
                
                setTimeout(() => {
                    if (window[callbackName]) {
                        reject(new Error('Request timeout'));
                        if (script.parentNode) document.head.removeChild(script);
                        delete window[callbackName];
                    }
                }, 60000);
                
                const queryParams = Object.keys(params).map(key => 
                    `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`
                ).join('&');
                
                const url = `${SHEET_CONFIG.webAppUrl}?action=${action}&callback=${callbackName}&timestamp=${Date.now()}&${queryParams}`;
                script.src = url;
                document.head.appendChild(script);
            });
        }
        
        async function sendExpiryReminders() {
            try {
                showLoading();
                console.log('Sending expiry reminders via Google Apps Script...');
                
                const result = await makeJSONPRequest('sendReminders', { type: 'expiry' });
                
                hideLoading();
                if (result.success) {
                    showToast(result.message);
                    console.log(`${result.emailsSent || 0} expiry reminders sent`);
                    
                    // Refresh data after sending reminders
                    setTimeout(() => {
                        loadDataFromGoogleSheets();
                    }, 1000);
                } else {
                    showError(result.error || 'Failed to send expiry reminders');
                }
            } catch (error) {
                hideLoading();
                console.error('Error sending expiry reminders:', error);
                showError(`Failed to send reminders: ${error.message}`);
            }
        }
        
        async function sendRentReminders() {
            try {
                showLoading();
                console.log('Sending rent reminders via Google Apps Script...');
                
                const result = await makeJSONPRequest('sendReminders', { type: 'rent' });
                
                hideLoading();
                if (result.success) {
                    showToast(result.message);
                    console.log(`${result.emailsSent || 0} rent reminders sent`);
                    
                    // Refresh data after sending reminders
                    setTimeout(() => {
                        loadDataFromGoogleSheets();
                    }, 1000);
                } else {
                    showError(result.error || 'Failed to send rent reminders');
                }
            } catch (error) {
                hideLoading();
                console.error('Error sending rent reminders:', error);
                showError(`Failed to send reminders: ${error.message}`);
            }
        }
        
        function refreshData() {
            console.log('Manual refresh triggered...');
            document.getElementById('tableSkeleton').style.display = 'block';
            document.getElementById('tenancyTable').style.display = 'none';
            document.getElementById('dashboardSkeleton').style.display = 'grid';
            document.getElementById('dashboardCards').style.display = 'none';
            
            loadDataFromGoogleSheets();
        }
        
        function showLoading() {
            document.getElementById('loadingIndicator').style.display = 'block';
            document.getElementById('tenancyTable').style.display = 'none';
            hideError();
        }
        
        function hideLoading() {
            document.getElementById('loadingIndicator').style.display = 'none';
        }
        
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.querySelector('.alert-message').textContent = message;
            errorDiv.style.display = 'flex';
            
            // Also show as toast
            showToast(message, true);
            
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }
        
        function hideError() {
            document.getElementById('errorMessage').style.display = 'none';
        }
        
        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            const toastMessage = toast.querySelector('.toast-message');
            
            toastMessage.textContent = message;
            
            if (isError) {
                toast.classList.add('error');
                toast.querySelector('i').className = 'fas fa-exclamation-circle';
            } else {
                toast.classList.remove('error');
                toast.querySelector('i').className = 'fas fa-check-circle';
            }
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>